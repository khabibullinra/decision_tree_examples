# Деревья решений и ценность информации VOI 
Репозиторий содержит примеры построения деревьев решений с использованием http://silverdecisions.pl/ созданные для учебных курсов РГУ нефти и газа имени И.М.Губкина
Также есть полезные расчетные инструменты для облегчения проведения расчетов деревьев решений.

# Задачи

## 1.Задача про покупку/продажу месторождения

### 1.1 Покупка месторождения

Вы покупаете месторождение. Известна геологическая оценка запасов

> * Текущие извлекаемые запасы – p10 - 1 млн тонн нефти
> * Текущие извлекаемые запасы – p50 - 1.1 млн тонн нефти
> * Текущие извлекаемые запасы – p90 - 1.2 млн тонн нефти
> * Стоимость 1 тонны нефти в запасах – 1 тыс. руб.

Готовы ли купить месторождение за 1.1 млрд.руб? Сколько вы готовы заплатить?

### 1.2 Продажа месторождения
> Вы продаете месторождение нефти. Как известно стоимость месторождения определяется подтвержденными запасами. Проведение исследований на разведочных скважинах, является важным элементом оценки запасов. Вам предлагают провести новый набор исследований, который, возможно, может увеличить величину подтвержденных запасов месторождений. Вам надо оценить,  стоит ли проводить предлагаемый комплекс исследований:

> * Стоимость исследования 10 млн руб
> * Текущие извлекаемые запасы – 1 млн тонн нефти
> * Стоимость 1 тонны нефти в запасах – 1 тыс. руб.

> Ожидаемая информация – фильтрационные параметры пласта, уточнение строение пласта, переоценка геологических и извлекаемых запасов.
> Вероятность успешности исследования - получения хоть какой-то информации - 70%
> Ожидается что исследование подтвердит увеличение запасов на 15% с вероятностью 60%, что запасы не изменятся - соответственно 40%. 
> Постройте дерево решений и примите решение  - стоит ли проводить исследование?
> Какова стоимость информации?

### 1.3 Продажа месторождения
> Вы продаете месторождение нефти. Как известно стоимость месторождения определяется подтвержденными запасами. Проведение исследований на разведочных скважинах, является важным элементом оценки запасов. Вам предлагают провести новый набор исследований, который, возможно, может увеличить величину подтвержденных запасов месторождений. Вам надо оценить,  стоит ли проводить предлагаемый комплекс исследований:

> * Стоимость исследования 10 млн руб
> * Оценка запасов из задачи 1
> * Стоимость 1 тонны нефти в запасах – 1 тыс. руб.

> Ожидаемая информация – снижение неопределенности в разбросах запасов.

с вероятностью 40 % вы ожидаете получить оценку
> * Текущие извлекаемые запасы – p10 - 1.1 млн тонн нефти
> * Текущие извлекаемые запасы – p50 - 1.16 млн тонн нефти
> * Текущие извлекаемые запасы – p90 - 1.21 млн тонн нефти

с вероятностью 20 % вы ожидаете получить оценку
> * Текущие извлекаемые запасы – p10 - 1 млн тонн нефти
> * Текущие извлекаемые запасы – p50 - 1.06 млн тонн нефти
> * Текущие извлекаемые запасы – p90 - 1.11 млн тонн нефти

> Вероятность успешности исследования - получения хоть какой-то информации - 70%
> Постройте дерево решений и примите решение  - стоит ли проводить исследование?
> Какова стоимость информации?


## 2.Задача про КВД, ОПЗ и скин фактор

### Условие задачи
> Вы эксплуатируете месторождение нефти. У вас есть добывающая скважина, которая уже отлично работает. Но вам кажется, что она может работать лучше. По опыту эксплуатации скважин-аналогов вы подозреваете наличие положительного скин-фактора, который можно удалить кислотной обработкой.

> Скважина дает 40 т/сут  (стоимость нефти 10 тыс.руб./т). 
> Скин-фактор S неизвестен. 

> Стоимость идеального ГДИС - КВД  1 млн.руб. 
> Стоимость ОПЗ  1 млн. руб.  Снижает скин в 2 раза. Эффект длится 1 год.

> Априорная информация 
> * S = 14  вероятность 50%
> * S = 7 вероятность 20%
> * S = 0 вероятность 30%

> Что делать? Какова стоимость информации для КВД в данных условиях. Какие параметры влияют на стоимость информации. Что надо изменить в условиях чтобы оправдать проведение более дорогих исследований?

### Решение

[Дерево с решением - открыть в silverdecisions.pl](http://silverdecisions.pl/SilverDecisions.html?LOAD_SD_TREE_JSON=https://raw.githubusercontent.com/khabibullinra/decision_tree_examples/main/silverdecision_examples/%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B0_%D0%BF%D1%80%D0%BE_%D0%9A%D0%92%D0%94_%D0%9E%D0%9F%D0%97_%D0%B8_%D1%81%D0%BA%D0%B8%D0%BD.json)


## 3.Задача про строительство скважины
 
### Условие задачи
> У вас имеется возможность построить новую скважину на одном из месторождений.
> Стоимость 100 млн.
>
> Геологическая оценка региона бурения:
> * Плохие условия:  Р = 15%, V = 80 млн. 
> * Хорошие условия:  Р = 60%, V = 100 млн. 
> * Отличные условия:  Р = 25%, V = 120 млн. 
>
> V - ожидаемый доход за период оценки
>
> Вопрос 3.1. Надо ли строить скважину? 
>
> Есть возможность уточнить геологию за 10 млн руб. Оценка геологии идеальная.
> Вопрос 2. Надо ли проводить исследования для уточнения геологии? Какова стоимость совершенной информации?
>
> Иимеется статистика по успешности геологических исследований, как она повлияет на решения?

|отчет/реальность| плохо | хорошо|отлично| итог|
|---|---|---|---|---|
|"плохо"| 6 | 3 | 1|  10|
|"хорошо"| 3 | 10 | 1|  14|
|"отлично"| 1 | 2 | 4|  7|
|итог| 10 | 15 | 6|  31|
>
> в таблице в столбцах оценка геологических условий, в строках - заключение исследований по изучению геологической обстановки
> Вопрос 3. Надо ли проводить исследования для уточнения геологии если учитывать статистику успешности? Какова стоимость несовершенной информации?

### Решение
[Дерево с решением - открыть в silverdecisions.pl](http://silverdecisions.pl/SilverDecisions.html?LOAD_SD_TREE_JSON=https://raw.githubusercontent.com/khabibullinra/decision_tree_examples/main/silverdecision_examples/%D0%97%D0%B0%D0%B4%D0%B0%D1%87%D0%B0_%D0%BF%D1%80%D0%BE_%D1%81%D1%82%D1%80%D0%BE%D0%B8%D1%82%D0%B5%D0%BB%D1%8C%D1%81%D1%82%D0%B2%D0%BE_%D1%81%D0%BA%D0%B2%D0%B0%D0%B6%D0%B8%D0%BD%D1%8B_%D0%B8_%D0%B8%D1%81%D1%81%D0%BB%D0%B5%D0%B4%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D1%8F.json)

Для учета статистики исследований и обновления априорной оценки вероятности "хорошести" геологии необходимо использовать [теорему Байеса](https://ru.wikipedia.org/wiki/%D0%A2%D0%B5%D0%BE%D1%80%D0%B5%D0%BC%D0%B0_%D0%91%D0%B0%D0%B9%D0%B5%D1%81%D0%B0). 
Для проведения расчета можно использовать [пример расчета в excel](https://github.com/khabibullinra/decision_tree_examples/raw/main/excel_utilities/%D0%A0%D0%B0%D1%81%D1%87%D0%B5%D1%82_%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BB%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F.xlsx)




# Расчетные модули

## Дискретизация логнормального распределения по заданным перцентялям p10, p50, p90

[Расчетный модуль Excel скачать](https://github.com/khabibullinra/decision_tree_examples/raw/main/excel_utilities/%D0%A0%D0%B0%D1%81%D1%87%D0%B5%D1%82_%D0%B4%D0%B8%D1%81%D0%BA%D1%80%D0%B5%D1%82%D0%BD%D0%BE%D0%B3%D0%BE_%D0%BB%D0%BE%D0%B3%D0%BD%D0%BE%D1%80%D0%BC%D0%B0%D0%BB%D1%8C%D0%BD%D0%BE%D0%B3%D0%BE_%D1%80%D0%B0%D1%81%D0%BF%D1%80%D0%B5%D0%B4%D0%B5%D0%BB%D0%B5%D0%BD%D0%B8%D1%8F.xlsx)

![Подбор логнормального распределения](/pics/excel1.png)

![Аппроксимация логнормального распределения дискретным](/pics/excel2.png)

Хабибуллин Ринат
2020
